<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê∏ Ultimate Pepe Faucet</title>
    
    <!-- Meta Etiketleri -->
    <meta name="description" content="Earn PEPE coins with our faucet">
    <meta name="keywords" content="pepe, faucet, crypto, earn">
    <meta name="author" content="Pepe Faucet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">
    
    <!-- CDN Baƒülantƒ±larƒ± -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/countup.js/2.0.7/countUp.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <!-- Ana Stil -->
    <style>
        /* √ñnceki stiller aynen kalacak */
        
        /* Yeni stiller */
        
        /* Daily Tasks */
        .task-card {
            background: var(--hover-bg);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }

        .task-card:hover {
            transform: translateX(5px);
            border-color: var(--primary);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-title {
            font-weight: bold;
            color: var(--primary);
        }

        .task-reward {
            background: rgba(46, 204, 113, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9em;
            color: var(--primary);
        }

        .task-progress {
            width: 100%;
            height: 8px;
            background: var(--background);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .task-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* User Stats Panel */
        .user-stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-mini-card {
            background: var(--hover-bg);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-mini-card:hover {
            transform: translateY(-3px);
        }

        .stat-mini-icon {
            font-size: 1.5em;
            color: var(--primary);
            margin-bottom: 5px;
        }

        /* Enhanced Profile Section */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: white;
            border: 3px solid var(--primary-dark);
        }

        .profile-info h2 {
            margin-bottom: 5px;
        }

        .profile-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .profile-badge {
            background: var(--hover-bg);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Activity Feed */
        .activity-feed {
            margin-top: 20px;
        }

        .activity-item {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: var(--hover-bg);
            border-radius: 10px;
            transition: all 0.3s;
        }

        .activity-item:hover {
            transform: translateX(5px);
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .activity-content {
            flex: 1;
        }

        .activity-time {
            font-size: 0.9em;
            color: var(--text-muted);
        }

        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid var(--primary);
            box-shadow: var(--neon-shadow);
            display: none;
            animation: slideIn 0.5s ease-out;
            z-index: 1000;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        /* Level Up Animation */
        @keyframes levelUp {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .level-up-animation {
            animation: levelUp 0.5s ease-out;
        }
    </style>
</head>
<body>
    <!-- Ana Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>üê∏ Pepe Faucet</h1>
                <div class="user-level">Level <span id="userLevel">1</span></div>
            </div>
            
            <div class="user-profile">
                <div class="profile-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-email"></div>
            </div>
            
            <div class="nav-item active" data-page="home">
                <i class="fas fa-home"></i>
                Ana Sayfa
            </div>
            
            <div class="nav-item" data-page="daily-tasks">
                <i class="fas fa-tasks"></i>
                G√ºnl√ºk G√∂revler
                <span class="notification-badge">3</span>
            </div>
            
            <div class="nav-item" data-page="withdraw">
                <i class="fas fa-wallet"></i>
                Para √áekme
            </div>
            
            <div class="nav-item" data-page="achievements">
                <i class="fas fa-trophy"></i>
                Ba≈üarƒ±mlar
                <span class="achievement-count badge">0</span>
            </div>

            <div class="nav-item" data-page="stats">
                <i class="fas fa-chart-line"></i>
                ƒ∞statistikler
            </div>
            
            <div class="nav-item" data-page="referral">
                <i class="fas fa-users"></i>
                Referans
            </div>

            <div class="nav-item" data-page="profile">
                <i class="fas fa-user"></i>
                Profil
            </div>
            
            <div class="nav-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                √áƒ±kƒ±≈ü Yap
            </div>
        </div>

        <!-- Ana ƒ∞√ßerik -->
        <div class="main-content">
            <!-- Ana Sayfa -->
            <div id="home" class="page active">
                <!-- User Stats Panel -->
                <div class="user-stats-panel">
                    <div class="stat-mini-card">
                        <div class="stat-mini-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="stat-mini-value" id="totalEarned">0</div>
                        <div class="stat-mini-label">Toplam Kazan√ß</div>
                    </div>
                    <div class="stat-mini-card">
                        <div class="stat-mini-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-mini-value" id="lastClaim">-</div>
                        <div class="stat-mini-label">Son Claim</div>
                    </div>
                    <div class="stat-mini-card">
                        <div class="stat-mini-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-mini-value" id="referralCount">0</div>
                        <div class="stat-mini-label">Referanslar</div>
                    </div>
                </div>

                <!-- Claim Card -->
                <div class="card">
                    <h2><i class="fas fa-coins"></i> Claim PEPE</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-gift"></i>
                            </div>
                            <div class="stat-value" id="claimAmount">800-2000</div>
                            <div>Her Claim</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-value" id="totalUsers">0</div>
                            <div>Toplam Kullanƒ±cƒ±</div>
                        </div>
                    </div>

                    <button class="action-btn" id="claimButton">
                        <i class="fas fa-gift"></i>
                        PEPE KAZAN!
                        <span class="loading" style="display: none;"></span>
                    </button>
                </div>

                <!-- Recent Claims -->
                <div class="card mt-4">
                    <h2><i class="fas fa-history"></i> Son ƒ∞≈ülemler</h2>
                    <div class="transaction-list" id="recentClaims"></div>
                </div>
            </div>

            <!-- G√ºnl√ºk G√∂revler -->
            <div id="daily-tasks" class="page">
                <h2><i class="fas fa-tasks"></i> G√ºnl√ºk G√∂revler</h2>
                
                <div class="task-list">
                    <!-- G√∂revler dinamik olarak eklenecek -->
                </div>
            </div>

            <!-- Diƒüer sayfalar aynƒ± kalacak -->
        </div>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <h3>üèÜ Yeni Ba≈üarƒ±m!</h3>
        <div class="achievement-details"></div>
    </div>

    <!-- Tema deƒüi≈ütirme butonu -->
    <button id="themeToggle" class="theme-toggle">
        <i class="fas fa-moon"></i>
    </button>

    <script>
// Konfig√ºrasyon
const config = {
    jsonbin: {
        binId: '67a7a415e41b4d34e4867ffe',
        apiKey: '$2a$10$m3ykh1NKxmtQDVM140H6TOTqsemkiBEdfdQnG/ApyhjJ1Duj2Ri6W'
    },
    faucetpay: {
        apiKey: 'a5a15c7cc4b4d4c6a0cab0cb5d2b2ce3388070028e2c5cf37284f627975cb9ed'
    },
    tasks: {
        daily: [
            {
                id: 'daily_claim',
                title: 'G√ºnl√ºk Claim',
                description: 'Bug√ºn 5 kez claim yap',
                target: 5,
                reward: 1000,
                type: 'claim'
            },
            {
                id: 'refer_friend',
                title: 'Arkada≈üƒ±nƒ± Davet Et',
                description: 'Bir arkada≈üƒ±nƒ± davet et',
                target: 1,
                reward: 500,
                type: 'referral'
            }
        ]
    },
    levels: {
        xpPerLevel: 1000,
        bonusPerLevel: 100
    }
};

// Oturum kontrol√º
function checkAuth() {
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    const userEmail = localStorage.getItem('userEmail');
    
    if (!isLoggedIn || !userEmail) {
        window.location.href = 'login.html';
        return;
    }
    
    return userEmail;
}

// Ana uygulama
class PepeFaucet {
    constructor() {
        this.userEmail = checkAuth();
        if (!this.userEmail) return;

        this.achievementSystem = new AchievementSystem();
        this.taskSystem = new TaskSystem();
        this.initialize();
        this.setupEventListeners();
        this.setupTheme();
    }

    async initialize() {
        try {
            const data = await Database.getData();
            if (data) {
                this.updateUI(data);
                this.initializeCounters(data);
                await this.taskSystem.loadTasks();
                await this.achievementSystem.checkAchievements(data.users[this.userEmail]);
            }
        } catch (error) {
            console.error('Ba≈ülatma hatasƒ±:', error);
            toastr.error('Sistem ba≈ülatƒ±lƒ±rken hata olu≈ütu');
        }
    }

    setupEventListeners() {
        // Sayfa ge√ßi≈üleri
        $('.nav-item').click(function() {
            if ($(this).hasClass('disabled')) return;
            
            $('.nav-item').removeClass('active');
            $(this).addClass('active');
            
            const page = $(this).data('page');
            $('.page').hide();
            $(`#${page}`).fadeIn();
        });

        // Claim butonu
        $('#claimButton').click(async (e) => {
            e.preventDefault();
            await this.handleClaim();
        });

        // Tema deƒüi≈ütirme
        $('#themeToggle').click(() => this.toggleTheme());
    }

    async handleClaim() {
        try {
            this.setLoading(true);
            const data = await Database.getData();
            if (!data) throw new Error('Veri y√ºklenemedi');

            const amount = this.calculatePayout();
            const transaction = {
                id: Date.now().toString(),
                email: this.userEmail,
                amount: amount,
                timestamp: new Date().toISOString(),
                status: 'success'
            };

            // Veritabanƒ±nƒ± g√ºncelle
            if (!data.transactions) data.transactions = [];
            if (!data.users) data.users = {};
            
            data.transactions.unshift(transaction);
            
            if (!data.users[this.userEmail]) {
                data.users[this.userEmail] = {
                    totalClaimed: amount,
                    claimCount: 1,
                    lastClaim: new Date().toISOString()
                };
            } else {
                data.users[this.userEmail].totalClaimed += amount;
                data.users[this.userEmail].claimCount += 1;
                data.users[this.userEmail].lastClaim = new Date().toISOString();
            }

            await Database.updateData(data);
            
            // G√∂rev ve ba≈üarƒ±m kontrol√º
            await this.taskSystem.updateProgress('claim');
            await this.achievementSystem.checkAchievements(data.users[this.userEmail]);
            
            // Animasyonlu bildirim
            this.showClaimAnimation(amount);
            
            // UI g√ºncelle
            this.updateUI(data);

        } catch (error) {
            console.error('Claim hatasƒ±:', error);
            toastr.error('ƒ∞≈ülem sƒ±rasƒ±nda hata olu≈ütu');
        } finally {
            this.setLoading(false);
        }
    }

    calculatePayout() {
        let base = Math.floor(Math.random() * (2000 - 800 + 1) + 800);
        
        // Level bonusu
        const level = parseInt(localStorage.getItem('userLevel') || '1');
        const bonus = (level - 1) * config.levels.bonusPerLevel;
        
        // ≈ûans fakt√∂r√º
        if (Math.random() < 0.05) {
            base *= 2;
            this.showLuckyAnimation();
        }
        
        return base + bonus;
    }

    showClaimAnimation(amount) {
        const popup = $('<div>')
            .addClass('claim-popup')
            .html(`
                <div class="claim-amount">+${amount}</div>
                <div class="claim-text">PEPE</div>
            `)
            .appendTo('body');

        setTimeout(() => popup.remove(), 2000);
    }

    showLuckyAnimation() {
        $('body').append('<div class="lucky-effect">2X BONUS!</div>');
        setTimeout(() => $('.lucky-effect').remove(), 2000);
    }

    updateUI(data) {
        const userData = data.users[this.userEmail] || {};
        
        // Animasyonlu saya√ßlar
        new CountUp('totalEarned', 0, userData.totalClaimed || 0, 0, 2.5, {
            useEasing: true,
            useGrouping: true
        }).start();

        // Son claim zamanƒ±
        if (userData.lastClaim) {
            $('#lastClaim').text(moment(userData.lastClaim).fromNow());
        }

        // Referans sayƒ±sƒ±
        $('#referralCount').text(userData.referralCount || 0);

        // ƒ∞≈ülem ge√ßmi≈üi
        this.updateTransactionHistory(data.transactions);

        // Lider tablosu
        this.updateLeaderboard(data.users);
    }

    updateTransactionHistory(transactions) {
        const history = transactions
            .filter(tx => tx.email === this.userEmail)
            .slice(0, 10)
            .map(tx => `
                <div class="activity-item">
                    <div class="activity-icon">
                        <i class="fas fa-gift"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-amount">+${tx.amount} PEPE</div>
                        <div class="activity-time">${moment(tx.timestamp).fromNow()}</div>
                    </div>
                </div>
            `)
            .join('');

        $('#recentClaims').html(history || '<p>Hen√ºz i≈ülem yok</p>');
    }

    updateLeaderboard(users) {
        const leaderboard = Object.entries(users)
            .sort((a, b) => b[1].totalClaimed - a[1].totalClaimed)
            .slice(0, 5)
            .map((user, index) => `
                <div class="leaderboard-item ${user[0] === this.userEmail ? 'current-user' : ''}">
                    <div class="rank">#${index + 1}</div>
                    <div class="user-info">
                        <div class="user-email">${this.maskEmail(user[0])}</div>
                        <div class="user-total">${user[1].totalClaimed.toLocaleString()} PEPE</div>
                    </div>
                </div>
            `)
            .join('');

        $('#leaderboard').html(leaderboard);
    }

    maskEmail(email) {
        const [name, domain] = email.split('@');
        return `${name.substring(0, 3)}***@${domain}`;
    }

    setLoading(isLoading) {
        const button = $('#claimButton');
        if (isLoading) {
            button.prop('disabled', true).addClass('loading');
        } else {
            button.prop('disabled', false).removeClass('loading');
        }
    }

    setupTheme() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
    }

    toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        
        const icon = $('#themeToggle i');
        icon.toggleClass('fa-moon fa-sun');
    }
}

// G√∂rev sistemi
class TaskSystem {
    constructor() {
        this.tasks = {};
        this.progress = JSON.parse(localStorage.getItem('taskProgress') || '{}');
    }

    async loadTasks() {
        config.tasks.daily.forEach(task => {
            if (!this.progress[task.id]) {
                this.progress[task.id] = {
                    current: 0,
                    completed: false,
                    lastReset: new Date().toISOString()
                };
            }
        });

        this.updateTaskUI();
        this.checkDailyReset();
    }

    async updateProgress(type) {
        const relevantTasks = config.tasks.daily.filter(task => task.type === type);
        
        relevantTasks.forEach(task => {
            if (!this.progress[task.id].completed) {
                this.progress[task.id].current++;
                
                if (this.progress[task.id].current >= task.target) {
                    this.progress[task.id].completed = true;
                    this.showTaskComplete(task);
                }
            }
        });

        localStorage.setItem('taskProgress', JSON.stringify(this.progress));
        this.updateTaskUI();
    }

    updateTaskUI() {
        const taskHtml = config.tasks.daily.map(task => {
            const progress = this.progress[task.id];
            const percent = (progress.current / task.target) * 100;
            
            return `
                <div class="task-card ${progress.completed ? 'completed' : ''}">
                    <div class="task-header">
                        <div class="task-title">${task.title}</div>
                        <div class="task-reward">+${task.reward} PEPE</div>
                    </div>
                    <div class="task-description">${task.description}</div>
                    <div class="task-progress">
                        <div class="task-progress-bar" style="width: ${percent}%"></div>
                    </div>
                    <div class="task-status">
                        ${progress.current}/${task.target}
                    </div>
                </div>
            `;
        }).join('');

        $('.task-list').html(taskHtml);
    }

    showTaskComplete(task) {
        toastr.success(`
            <div class="task-complete">
                <div class="task-complete-title">G√∂rev Tamamlandƒ±!</div>
                <div class="task-complete-reward">+${task.reward} PEPE kazandƒ±n!</div>
            </div>
        `);
    }

    checkDailyReset() {
        Object.keys(this.progress).forEach(taskId => {
            const lastReset = new Date(this.progress[taskId].lastReset);
            const now = new Date();
            
            if (lastReset.getDate() !== now.getDate()) {
                this.progress[taskId] = {
                    current: 0,
                    completed: false,
                    lastReset: now.toISOString()
                };
            }
        });

        localStorage.setItem('taskProgress', JSON.stringify(this.progress));
    }
}

// Ba≈üarƒ±m sistemi
class AchievementSystem {
    // √ñnceki achievement sistemi kodlarƒ±
}

// Veritabanƒ± i≈ülemleri
class Database {
    // √ñnceki database kodlarƒ±
}

// Toast bildirimleri
toastr.options = {
    "closeButton": true,
    "progressBar": true,
    "positionClass": "toast-bottom-right",
    "preventDuplicates": true,
    "timeOut": "3000",
    "showEasing": "swing",
    "hideEasing": "linear",
    "showMethod": "fadeIn",
    "hideMethod": "fadeOut"
};

// Uygulamayƒ± ba≈ülat
$(document).ready(() => {
    // Oturum kontrol√º
    const userEmail = checkAuth();
    if (!userEmail) return;
    
    // Uygulamayƒ± ba≈ülat
    const app = new PepeFaucet();
});
</script>
</body>
</html>
