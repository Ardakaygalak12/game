<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê∏ Ultimate Pepe Faucet v2.0</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <style>
        /* √ñnceki stil kodlarƒ± aynen kalacak */
        /* Yeni animasyonlar ve efektler ekliyoruz */
        @keyframes pepePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pepe-animation {
            animation: pepePulse 2s infinite;
        }

        .payment-success {
            animation: successPulse 0.5s;
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Yeni stil eklemeleri */
        .premium-badge {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: black;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .achievement-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            border: 2px solid var(--primary);
            display: none;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body>
    <script>
        // G√ºvenlik konfig√ºrasyonu
        const JSONBIN_CONFIG = {
            BIN_ID: '67a7a415e41b4d34e4867ffe',
            API_KEY: '$2a$10$m3ykh1NKxmtQDVM140H6TOTqsemkiBEdfdQnG/ApyhjJ1Duj2Ri6W',
            FAUCETPAY_KEY: 'a5a15c7cc4b4d4c6a0cab0cb5d2b2ce3388070028e2c5cf37284f627975cb9ed'
        };

        // G√ºvenlik sƒ±nƒ±fƒ±
        class Security {
            static encryptData(data) {
                return CryptoJS.AES.encrypt(JSON.stringify(data), JSONBIN_CONFIG.API_KEY).toString();
            }

            static decryptData(encryptedData) {
                const bytes = CryptoJS.AES.decrypt(encryptedData, JSONBIN_CONFIG.API_KEY);
                return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));
            }

            static async validateIPAccess() {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip === '127.0.0.1';
            }
        }

        // Veritabanƒ± i≈ülemleri
        class Database {
            static async getData() {
                try {
                    const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.BIN_ID}/latest`, {
                        headers: {
                            'X-Master-Key': JSONBIN_CONFIG.API_KEY
                        }
                    });
                    const data = await response.json();
                    return data.record;
                } catch (error) {
                    console.error('Veri √ßekme hatasƒ±:', error);
                    return null;
                }
            }

            static async updateData(newData) {
                try {
                    const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.BIN_ID}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_CONFIG.API_KEY
                        },
                        body: JSON.stringify(newData)
                    });
                    return await response.json();
                } catch (error) {
                    console.error('Veri g√ºncelleme hatasƒ±:', error);
                    return null;
                }
            }
        }

        // FaucetPay API i≈ülemleri
        class FaucetPayAPI {
            static async sendPayment(email, amount) {
                try {
                    const response = await fetch('https://faucetpay.io/api/v1/send', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            api_key: JSONBIN_CONFIG.FAUCETPAY_KEY,
                            to: email,
                            amount: amount,
                            currency: 'PEPE'
                        })
                    });
                    return await response.json();
                } catch (error) {
                    console.error('√ñdeme hatasƒ±:', error);
                    return null;
                }
            }

            static async checkBalance() {
                try {
                    const response = await fetch('https://faucetpay.io/api/v1/balance', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            api_key: JSONBIN_CONFIG.FAUCETPAY_KEY,
                            currency: 'PEPE'
                        })
                    });
                    return await response.json();
                } catch (error) {
                    console.error('Bakiye kontrol√º hatasƒ±:', error);
                    return null;
                }
            }
        }

        // Ba≈üarƒ± sistemi
        class AchievementSystem {
            static achievements = {
                FIRST_CLAIM: {
                    id: 'first_claim',
                    title: 'ƒ∞lk √ñdeme',
                    description: 'ƒ∞lk PEPE √∂demenizi aldƒ±nƒ±z!',
                    reward: 50
                },
                REFERRAL_MASTER: {
                    id: 'referral_master',
                    title: 'Referans Ustasƒ±',
                    description: '5 arkada≈üƒ±nƒ±zƒ± davet ettiniz!',
                    reward: 100
                }
                // Daha fazla ba≈üarƒ± eklenebilir
            };

            static async checkAndAwardAchievement(userId, achievementId) {
                const data = await Database.getData();
                const user = data.users[userId];

                if (!user.achievements) {
                    user.achievements = [];
                }

                if (!user.achievements.includes(achievementId)) {
                    user.achievements.push(achievementId);
                    const achievement = this.achievements[achievementId];
                    
                    // √ñd√ºl√º ver
                    await FaucetPayAPI.sendPayment(userId, achievement.reward);
                    
                    // Ba≈üarƒ± popup'ƒ± g√∂ster
                    this.showAchievementPopup(achievement);
                    
                    // Veritabanƒ±nƒ± g√ºncelle
                    await Database.updateData(data);
                }
            }

            static showAchievementPopup(achievement) {
                const popup = $('<div>')
                    .addClass('achievement-popup')
                    .html(`
                        <h3>üèÜ Yeni Ba≈üarƒ±!</h3>
                        <p>${achievement.title}</p>
                        <p>${achievement.description}</p>
                        <p>√ñd√ºl: ${achievement.reward} PEPE</p>
                    `)
                    .appendTo('body')
                    .fadeIn();

                setTimeout(() => popup.fadeOut(() => popup.remove()), 5000);
            }
        }

        // Ana uygulama
        class PepeFaucet {
            constructor() {
                this.initialize();
                this.setupEventListeners();
            }

            async initialize() {
                await this.loadInitialData();
                this.updateUI();
                this.checkForAchievements();
            }

            async loadInitialData() {
                this.data = await Database.getData();
                this.balance = await FaucetPayAPI.checkBalance();
            }

            setupEventListeners() {
                $('#faucetForm').on('submit', (e) => this.handleClaim(e));
                $('#referralLink').on('click', () => this.copyReferralLink());
            }

            async handleClaim(e) {
                e.preventDefault();
                
                const email = $('#faucetpayEmail').val();
                const amount = this.calculatePayout();

                $('#paymentLoader').show();
                const payment = await FaucetPayAPI.sendPayment(email, amount);
                $('#paymentLoader').hide();

                if (payment.success) {
                    this.showSuccess(amount);
                    await this.updateStats(email, amount);
                    await AchievementSystem.checkAndAwardAchievement(email, 'FIRST_CLAIM');
                } else {
                    this.showError(payment.message);
                }
            }

            calculatePayout() {
                // Temel √∂deme
                let amount = Math.floor(Math.random() * (2000 - 800 + 1)) + 800;
                
                // ≈ûans fakt√∂r√º
                const luck = Math.random();
                if (luck > 0.95) { // %5 ≈üans
                    amount *= 2; // 2x bonus
                }
                
                return amount;
            }

            async updateStats(email, amount) {
                this.data.stats.totalPaid += amount;
                this.data.stats.totalUsers += 1;
                this.data.stats.lastPayout = new Date().toISOString();

                if (!this.data.users[email]) {
                    this.data.users[email] = {
                        totalClaimed: amount,
                        lastClaim: new Date().toISOString(),
                        claimCount: 1
                    };
                } else {
                    this.data.users[email].totalClaimed += amount;
                    this.data.users[email].lastClaim = new Date().toISOString();
                    this.data.users[email].claimCount += 1;
                }

                await Database.updateData(this.data);
                this.updateUI();
            }

            showSuccess(amount) {
                toastr.success(`üéâ Tebrikler! ${amount} PEPE kazandƒ±nƒ±z!`);
                $('#claimButton').addClass('payment-success');
                setTimeout(() => $('#claimButton').removeClass('payment-success'), 500);
            }

            showError(message) {
                toastr.error(`‚ùå Hata: ${message}`);
            }

            updateUI() {
                $('#totalPaid').text(this.data.stats.totalPaid.toLocaleString());
                $('#totalUsers').text(this.data.stats.totalUsers.toLocaleString());
                
                if (this.balance) {
                    $('#faucetBalance').text(this.balance.balance.toLocaleString());
                }
            }

            async checkForAchievements() {
                const email = localStorage.getItem('userEmail');
                if (email) {
                    const user = this.data.users[email];
                    if (user) {
                        if (user.claimCount === 1) {
                            await AchievementSystem.checkAndAwardAchievement(email, 'FIRST_CLAIM');
                        }
                        if (user.referralCount >= 5) {
                            await AchievementSystem.checkAndAwardAchievement(email, 'REFERRAL_MASTER');
                        }
                    }
                }
            }
        }

        // Uygulama ba≈ülatma
        $(document).ready(() => {
            const app = new PepeFaucet();
        });
    </script>

    <!-- HTML i√ßeriƒüi - ana faucet sayfasƒ± -->
    <div class="container">
        <!-- Ana i√ßerik b√∂l√ºm√º -->
    </div>

    <!-- Ba≈üarƒ± popup container -->
    <div id="achievementPopup" class="achievement-popup"></div>
</body>
</html>
