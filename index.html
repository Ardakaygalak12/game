<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê∏ Cyber Pepe Mining Platform</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --pepe-green: #45D754;
            --pepe-dark: #1E4620;
            --cyber-glow: 0 0 15px var(--pepe-green);
            --cyber-glow-intense: 0 0 25px var(--pepe-green);
        }
        
        /* Enhanced Background */
        body {
            background-color: #0F1F11;
            color: #ffffff;
            font-family: 'Arial', sans-serif;
            background-image: 
                radial-gradient(circle at 100% 100%, rgba(69, 215, 84, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 0% 0%, rgba(69, 215, 84, 0.15) 0%, transparent 50%),
                linear-gradient(45deg, rgba(69, 215, 84, 0.05) 0%, transparent 20%),
                linear-gradient(-45deg, rgba(69, 215, 84, 0.05) 0%, transparent 20%);
            background-attachment: fixed;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Cyber Pepe Character Animations */
        .cyber-pepe {
            width: 120px;
            height: 120px;
            position: relative;
            margin: 20px auto;
            transition: all 0.3s ease;
        }

        .cyber-pepe::before {
            content: 'üê∏';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 50px;
            filter: drop-shadow(0 0 10px var(--pepe-green));
            animation: float 3s ease-in-out infinite;
        }

        .cyber-pepe.mining::before {
            animation: miningBounce 0.5s ease-in-out infinite alternate;
        }

        @keyframes miningBounce {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(-50%, -50%) scale(1.1) rotate(5deg); }
        }

        /* Enhanced Mining Progress Bar */
        .progress-cyber {
            width: 100%;
            height: 25px;
            background: rgba(30, 70, 32, 0.3);
            border: 2px solid var(--pepe-green);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .progress-cyber::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: progressShine 2s linear infinite;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, 
                var(--pepe-green), 
                #2FFF35, 
                var(--pepe-green));
            background-size: 200% 100%;
            animation: gradientMove 2s linear infinite;
            transition: width 0.3s linear;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            background: rgba(255,255,255,0.8);
            filter: blur(3px);
        }

        @keyframes progressShine {
            from { transform: translateX(-100%); }
            to { transform: translateX(100%); }
        }

        @keyframes gradientMove {
            from { background-position: 100% 0; }
            to { background-position: -100% 0; }
        }

        /* Cyber Button Enhancements */
        .cyber-button {
            background: var(--pepe-green);
            color: white;
            border: none;
            padding: 1rem 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            text-transform: uppercase;
            letter-spacing: 1px;
            clip-path: polygon(
                10px 0, 
                calc(100% - 10px) 0, 
                100% 10px, 
                100% calc(100% - 10px), 
                calc(100% - 10px) 100%, 
                10px 100%, 
                0 calc(100% - 10px), 
                0 10px
            );
        }

        .cyber-button:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--cyber-glow);
            border-color: var(--pepe-green);
            background: transparent;
        }

        .cyber-button:hover::before {
            transform: translateX(100%);
        }

        .cyber-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            transition: transform 0.5s ease;
        }

        /* Enhanced Card Styles */
        .cyber-card {
            background: rgba(30, 70, 32, 0.2);
            border: 1px solid var(--pepe-green);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .cyber-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(69, 215, 84, 0.1),
                transparent
            );
            animation: cardShine 8s infinite;
        }

        @keyframes cardShine {
            0% { transform: translateX(0); }
            20% { transform: translateX(200%); }
            100% { transform: translateX(200%); }
        }

        /* Stats Display */
        .stats-value {
            font-family: 'Courier New', monospace;
            color: var(--pepe-green);
            text-shadow: var(--cyber-glow);
            position: relative;
            padding: 0.5rem 1rem;
            background: rgba(69, 215, 84, 0.1);
            border-radius: 4px;
            border: 1px solid var(--pepe-green);
        }

        .stats-value.updating {
            animation: statsUpdate 0.5s ease;
        }

        @keyframes statsUpdate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Enhanced Toast Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 1rem;
            border-radius: 8px;
            background: rgba(30, 70, 32, 0.9);
            border: 1px solid var(--pepe-green);
            color: white;
            z-index: 1000;
            backdrop-filter: blur(8px);
            animation: toastSlide 0.3s ease-out;
            box-shadow: var(--cyber-glow);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        @keyframes toastSlide {
            from { transform: translateX(100%) translateY(100%); opacity: 0; }
            to { transform: translateX(0) translateY(0); opacity: 1; }
        }

        /* Loading Animation */
        .cyber-loading {
            width: 60px;
            height: 60px;
            border: 3px solid var(--pepe-dark);
            border-radius: 50%;
            border-top-color: var(--pepe-green);
            animation: cyberSpin 1s linear infinite;
            position: relative;
        }

        .cyber-loading::before,
        .cyber-loading::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border: 3px solid transparent;
            border-top-color: var(--pepe-green);
            border-radius: 50%;
            animation: cyberSpinReverse 2s linear infinite;
            opacity: 0.5;
        }

        .cyber-loading::after {
            animation: cyberSpin 3s linear infinite;
            opacity: 0.3;
        }

        @keyframes cyberSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes cyberSpinReverse {
            0% { transform: rotate(360deg); }
            100% { transform: rotate(0deg); }
        }

        /* Modal Enhancements */
        .cyber-modal {
            background: rgba(15, 31, 17, 0.95);
            border: 2px solid var(--pepe-green);
            box-shadow: var(--cyber-glow);
            backdrop-filter: blur(10px);
            animation: modalEnter 0.3s ease-out;
            position: relative;
        }

        .cyber-modal::before {
            content: '';
            position: absolute;
            inset: -2px;
            border: 2px solid var(--pepe-green);
            animation: modalBorder 2s linear infinite;
            opacity: 0.5;
        }

        @keyframes modalEnter {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        @keyframes modalBorder {
            0% { clip-path: inset(0 0 98% 0); }
            25% { clip-path: inset(0 98% 0 0); }
            50% { clip-path: inset(98% 0 0 0); }
            75% { clip-path: inset(0 0 0 98%); }
            100% { clip-path: inset(0 0 98% 0); }
        }
    </style>
</head>
<body>
    <!-- Enhanced Navigation -->
    <nav class="bg-green-900 bg-opacity-90 p-4 sticky top-0 z-50 backdrop-filter backdrop-blur">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <div class="cyber-pepe w-12 h-12"></div>
                <h1 class="text-2xl font-bold tracking-wider">
                    <span class="text-green-400">CYBER</span> 
                    <span class="text-white">PEPE</span>
                </h1>
            </div>
            <!-- User Balance Section -->
            <div id="userSection" class="hidden">
                <div class="flex items-center space-x-4">
                    <div class="stats-value flex items-center">
                        <span class="mr-2">üí∞</span>
                        <span id="userBalance">0 PEPE</span>
                    </div>
                    <button onclick="logout()" class="cyber-button bg-red-500">
                        <span class="mr-2">üö™</span> Exit
                    </button>
                </div>
            </div>
            <!-- Auth Buttons -->
            <div id="authButtons" class="space-x-4">
                <button onclick="showLoginModal()" class="cyber-button">
                    <span class="mr-2">üîë</span> Login
                </button>
                <button onclick="showRegisterModal()" class="cyber-button bg-white text-green-600">
                    <span class="mr-2">üìù</span> Register
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto mt-8 px-4">
        <!-- Welcome Banner -->
        <div class="cyber-card p-8 rounded-xl mb-8 text-center">
            <h2 class="text-4xl font-bold mb-4">
                <span class="text-green-400">CYBER</span> 
                <span class="inline-block transform hover:scale-110 transition-transform">üê∏</span> 
                <span class="text-green-400">MINING</span>
            </h2>
            <p class="text-xl mb-6 text-gray-300">Mine, Earn, Trade - The Cyber Way!</p>
            
            <!-- Feature Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Mining Feature -->
                <div class="cyber-card p-6 transform hover:scale-105 transition-all duration-300">
                    <div class="text-4xl mb-4">‚õèÔ∏è</div>
                    <h3 class="text-xl font-bold mb-2 text-green-400">Active Mining</h3>
                    <p class="text-gray-300">Mine continuously for 7 hours to maximize your earnings!</p>
                </div>
                <!-- Rewards Feature -->
                <div class="cyber-card p-6 transform hover:scale-105 transition-all duration-300">
                    <div class="text-4xl mb-4">üéÅ</div>
                    <h3 class="text-xl font-bold mb-2 text-green-400">Daily Rewards</h3>
                    <p class="text-gray-300">Claim special bonus rewards every day!</p>
                </div>
                <!-- Trading Feature -->
                <div class="cyber-card p-6 transform hover:scale-105 transition-all duration-300">
                    <div class="text-4xl mb-4">üí±</div>
                    <h3 class="text-xl font-bold mb-2 text-green-400">Quick Trade</h3>
                    <p class="text-gray-300">Convert your PEPE tokens instantly!</p>
                </div>
            </div>
        </div>

        <!-- Mining Interface -->
        <div id="miningSection" class="hidden">
            <div class="cyber-card p-6 rounded-xl mb-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <span class="text-3xl mr-2">‚õèÔ∏è</span>
                    Active Mining
                </h2>
                
                <!-- Mining Animation -->
                <div class="cyber-pepe"></div>
                
                <!-- Mining Progress -->
                <div class="mb-6">
                    <div class="progress-cyber">
                        <div class="progress-fill" id="miningProgress"></div>
                    </div>
                    <div class="flex justify-between mt-2">
                        <span class="text-sm text-gray-400">Progress:</span>
                        <span class="stats-value text-sm" id="progressText">0%</span>
                    </div>
                </div>
                
                <!-- Mining Stats -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="cyber-card p-4">
                        <h4 class="text-sm text-gray-400">Mining Rate</h4>
                        <div class="stats-value" id="miningRate">0 PEPE/s</div>
                    </div>
                    <div class="cyber-card p-4">
                        <h4 class="text-sm text-gray-400">Total Mined</h4>
                        <div class="stats-value" id="totalMined">0 PEPE</div>
                    </div>
                </div>
                
                <!-- Mining Controls -->
                <button id="miningButton" class="cyber-button w-full py-4 text-xl">
                    <span class="mr-2">‚ö°</span>
                    Start Mining
                </button>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="hidden">
            <div class="cyber-card p-6 rounded-xl">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <span class="text-3xl mr-2">üëë</span>
                    Admin Dashboard
                </h2>
                
                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="cyber-card p-4">
                        <h4 class="text-gray-400 mb-2">Total Users</h4>
                        <div class="stats-value text-2xl" id="totalUsers">0</div>
                    </div>
                    <div class="cyber-card p-4">
                        <h4 class="text-gray-400 mb-2">Active Miners</h4>
                        <div class="stats-value text-2xl" id="activeMiners">0</div>
                    </div>
                    <div class="cyber-card p-4">
                        <h4 class="text-gray-400 mb-2">Total PEPE</h4>
                        <div class="stats-value text-2xl" id="totalTokens">0</div>
                    </div>
                </div>
                
                <!-- Mining Activity -->
                <div class="cyber-card p-4 mb-8">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <span class="text-2xl mr-2">üìä</span>
                        Live Mining Activity
                    </h3>
                    <div id="miningActivity" class="max-h-60 overflow-y-auto space-y-2">
                        <!-- Activity items will be inserted here -->
                    </div>
                </div>
                
                <!-- User Management -->
                <div class="cyber-card p-4 mb-8">
                    <h3 class="text-xl font-bold mb-4">üë• User Management</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b border-green-500">
                                    <th class="p-2 text-left">User</th>
                                    <th class="p-2 text-left">Balance</th>
                                    <th class="p-2 text-left">Mining Status</th>
                                    <th class="p-2 text-left">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="userList">
                                <!-- User rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Login Modal -->
    <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="cyber-modal p-8 rounded-xl w-96">
            <h2 class="text-2xl font-bold mb-6">üîë Login</h2>
            <input type="email" id="loginEmail" 
                   class="cyber-input w-full p-3 mb-4 rounded-lg bg-black bg-opacity-50" 
                   placeholder="Email">
            <input type="password" id="loginPassword" 
                   class="cyber-input w-full p-3 mb-6 rounded-lg bg-black bg-opacity-50" 
                   placeholder="Password">
            <div class="flex justify-end space-x-4">
                <button onclick="closeLoginModal()" 
                        class="cyber-button bg-gray-600">
                    Cancel
                </button>
                <button onclick="login()" 
                        class="cyber-button">
                    Login
                </button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="hidden fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="cyber-modal p-8 rounded-xl w-96">
            <h2 class="text-2xl font-bold mb-6">üìù Register</h2>
            <input type="email" id="registerEmail" 
                   class="cyber-input w-full p-3 mb-4 rounded-lg bg-black bg-opacity-50" 
                   placeholder="Email">
            <input type="password" id="registerPassword" 
                   class="cyber-input w-full p-3 mb-6 rounded-lg bg-black bg-opacity-50" 
                   placeholder="Password">
            <div class="flex justify-end space-x-4">
                <button onclick="closeRegisterModal()" 
                        class="cyber-button bg-gray-600">
                    Cancel
                </button>
                <button onclick="register()" 
                        class="cyber-button">
                    Register
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="hidden fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="cyber-loading"></div>
    </div>

    <script>
        // Constants
        const MINING_DURATION = 7 * 60 * 60 * 1000; // 7 hours
        const BASE_REWARD_RATE = 0.1; // PEPE per second
        const BIN_ID = '678d525ae41b4d34e47ad3b8';
        const API_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;
        const MASTER_KEY = '$2a$10$m3ykh1NKxmtQDVM140H6TOTqsemkiBEdfdQnG/ApyhjJ1Duj2Ri6W';
        
        // State Management
        let miningInterval = null;
        let miningStartTime = 0;
        let totalMined = 0;
        let isAdmin = false;
        let isLoggedIn = false;
        let currentMiningPower = 1;

        // Enhanced Mining System
        function startMining() {
            if (miningInterval) return;
            
            miningStartTime = Date.now();
            document.querySelector('.cyber-pepe').classList.add('mining');
            
            updateMiningButton(true);
            initializeMiningAnimation();
            
            miningInterval = setInterval(updateMining, 100); // Smoother updates
            
            showToast('‚õèÔ∏è Mining started! Keep the page open to continue mining.');
        }

        function updateMining() {
            const now = Date.now();
            const elapsed = now - miningStartTime;
            const progress = Math.min((elapsed / MINING_DURATION) * 100, 100);
            
            // Update progress bar and text
            document.getElementById('miningProgress').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `${Math.floor(progress)}%`;
            
            // Calculate and update mining rate
            const miningRate = calculateMiningRate(progress);
            document.getElementById('miningRate').textContent = `${miningRate.toFixed(3)} PEPE/s`;
            
            // Update total mined
            totalMined += miningRate * 0.1; // Since we update every 100ms
            document.getElementById('totalMined').textContent = `${Math.floor(totalMined)} PEPE`;
            
            if (progress >= 100) {
                completeMining();
            }
        }

        function calculateMiningRate(progress) {
            const baseRate = BASE_REWARD_RATE * currentMiningPower;
            const progressBonus = 1 + (progress / 100); // Up to 2x bonus at 100%
            return baseRate * progressBonus;
        }

        async function completeMining() {
            clearInterval(miningInterval);
            miningInterval = null;
            
            const finalReward = Math.floor(totalMined);
            document.querySelector('.cyber-pepe').classList.remove('mining');
            
            try {
                const data = await getData();
                const currentUser = localStorage.getItem('currentUser');
                
                // Update user balance
                data.balances[currentUser] = (data.balances[currentUser] || 0) + finalReward;
                data.stats.totalTokens += finalReward;
                
                // Add mining history
                data.miningHistory = data.miningHistory || [];
                data.miningHistory.push({
                    user: currentUser,
                    reward: finalReward,
                    duration: MINING_DURATION,
                    timestamp: new Date().toISOString()
                });
                
                await saveData(data);
                
                showSuccessfulMining(finalReward);
                updateBalance(data.balances[currentUser]);
                resetMiningInterface();
                
            } catch (error) {
                showToast('‚ùå Error completing mining session', 'error');
            }
        }

        function showSuccessfulMining(reward) {
            showToast(`üéâ Mining Complete! Earned ${reward} PEPE!`, 'success', 5000);
            
            // Trigger celebration animation
            const pepe = document.querySelector('.cyber-pepe');
            pepe.style.animation = 'celebration 1s ease-in-out';
            // Enhanced UI Functions
        function resetMiningInterface() {
            document.getElementById('miningProgress').style.width = '0%';
            document.getElementById('progressText').textContent = '0%';
            document.getElementById('miningRate').textContent = '0 PEPE/s';
            document.getElementById('totalMined').textContent = '0 PEPE';
            updateMiningButton(false);
            totalMined = 0;
        }

        function updateMiningButton(isMining) {
            const button = document.getElementById('miningButton');
            if (isMining) {
                button.innerHTML = '<span class="mr-2">‚ö°</span> Mining in Progress...';
                button.disabled = true;
                button.classList.add('opacity-50');
            } else {
                button.innerHTML = '<span class="mr-2">‚ö°</span> Start Mining';
                button.disabled = false;
                button.classList.remove('opacity-50');
            }
        }

        // Enhanced Animation Functions
        function initializeMiningAnimation() {
            const pepe = document.querySelector('.cyber-pepe');
            pepe.style.animation = 'none';
            pepe.offsetHeight; // Trigger reflow
            pepe.style.animation = null;
            pepe.classList.add('mining');
        }

        // Enhanced Toast System
        function showToast(message, type = 'success', duration = 3000) {
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.className = `toast ${type === 'success' ? 'bg-green-900' : 'bg-red-900'}`;
            toast.innerHTML = `
                <div class="flex items-center">
                    <span class="text-2xl mr-2">${type === 'success' ? '‚úÖ' : '‚ùå'}</span>
                    <span>${message}</span>
                </div>
                <div class="toast-progress"></div>
            `;

            document.body.appendChild(toast);

            // Add progress bar animation
            const progress = document.createElement('style');
            progress.innerHTML = `
                @keyframes toast-progress {
                    to { width: 0% }
                }
                .toast-progress {
                    width: 100%;
                    height: 3px;
                    background: ${type === 'success' ? '#45D754' : '#ff4444'};
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    animation: toast-progress ${duration}ms linear;
                }
            `;
            document.head.appendChild(progress);

            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease-out forwards';
                setTimeout(() => {
                    toast.remove();
                    progress.remove();
                }, 300);
            }, duration);
        }

        // Enhanced Admin Functions
        async function updateAdminDashboard() {
            if (!isAdmin) return;

            try {
                const data = await getData();
                
                // Update stats with animations
                updateStatWithAnimation('totalUsers', data.stats.totalUsers);
                updateStatWithAnimation('activeMiners', getActiveMinerCount(data));
                updateStatWithAnimation('totalTokens', data.stats.totalTokens);

                // Update mining activity feed
                updateMiningActivityFeed(data.miningHistory || []);

                // Update user list with enhanced details
                updateUserList(data);

            } catch (error) {
                showToast('Error updating dashboard', 'error');
            }
        }

        function updateStatWithAnimation(elementId, value) {
            const element = document.getElementById(elementId);
            if (!element) return;

            element.classList.add('updating');
            element.textContent = value.toLocaleString();

            setTimeout(() => {
                element.classList.remove('updating');
            }, 500);
        }

        function updateMiningActivityFeed(history) {
            const activityFeed = document.getElementById('miningActivity');
            if (!activityFeed) return;

            const recentActivity = history
                .slice(-10)
                .reverse()
                .map(activity => `
                    <div class="cyber-card p-3 transform hover:scale-[1.02] transition-all">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center">
                                <span class="text-green-400 mr-2">‚õèÔ∏è</span>
                                <span>${activity.user}</span>
                            </div>
                            <span class="stats-value">+${activity.reward} PEPE</span>
                        </div>
                        <small class="text-gray-400 block mt-1">
                            ${new Date(activity.timestamp).toLocaleString()}
                        </small>
                    </div>
                `)
                .join('');

            activityFeed.innerHTML = recentActivity || '<p class="text-gray-400">No mining activity yet</p>';
        }

        function updateUserList(data) {
            const userList = document.getElementById('userList');
            if (!userList) return;

            const userRows = data.users.map(user => {
                const balance = data.balances[user.email] || 0;
                const isMining = data.miningTimes[user.email] > Date.now() - MINING_DURATION;

                return `
                    <tr class="border-b border-green-500 hover:bg-green-900 hover:bg-opacity-20 transition-all">
                        <td class="p-3">${user.email}</td>
                        <td class="p-3">
                            <span class="stats-value">${balance} PEPE</span>
                        </td>
                        <td class="p-3">
                            <span class="px-2 py-1 rounded-full ${isMining ? 'bg-green-500' : 'bg-gray-500'}">
                                ${isMining ? 'üü¢ Mining' : '‚ö´ Idle'}
                            </span>
                        </td>
                        <td class="p-3">
                            <button onclick="showUserDetails('${user.email}')" 
                                    class="cyber-button p-2">
                                View Details
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');

            userList.innerHTML = userRows;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                isLoggedIn = true;
                isAdmin = currentUser === ADMIN_EMAIL;
                await updateUIState();

                if (isAdmin) {
                    // Start real-time updates for admin
                    setInterval(updateAdminDashboard, 5000);
                }
            }

            // Add click handler for mining button
            document.getElementById('miningButton')?.addEventListener('click', startMining);
        });

        // Event Listeners
        function setupEventListeners() {
            // Input validation for coupon code
            document.getElementById('couponInput')?.addEventListener('input', (e) => {
                e.target.value = e.target.value.toUpperCase();
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeLoginModal();
                    closeRegisterModal();
                }
                if (e.key === 'Enter') {
                    if (!document.getElementById('loginModal').classList.contains('hidden')) {
                        login();
                    }
                    if (!document.getElementById('registerModal').classList.contains('hidden')) {
                        register();
                    }
                }
            });
        }

        // Initialize event listeners
        setupEventListeners();
    </script>
</body>
</html>
